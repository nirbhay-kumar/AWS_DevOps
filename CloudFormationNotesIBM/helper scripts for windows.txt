These are the four CloudFormation helper scripts for Windows:

‚úÖ 1. cfn-init

Used to read and apply the Metadata section of CloudFormation (packages, files, commands, services).

üìå Run it manually (debug mode)
cfn-init.exe -v `
  --stack MyStack `
  --resource MyEC2Instance `
  --region ap-south-1

üìå Typical use inside UserData
<powershell>
cfn-init.exe -v --stack MyStack --resource MyEC2Instance --region ap-south-1
</powershell>

‚úÖ 2. cfn-hup

A daemon that monitors CloudFormation metadata changes and re-runs cfn-init when configs update.

üìå Start the service
Start-Service cfn-hup

üìå Restart (after configuration change)
Restart-Service cfn-hup

üìå Run manually in verbose mode
cfn-hup.exe -v

üìå Log file path
C:\cfn\log\cfn-hup.log

‚úÖ 3. cfn-signal

Used to send a success or failure signal back to CloudFormation for wait conditions (CreationPolicy / WaitCondition).

üìå On success
cfn-signal.exe -e 0 `
  --stack MyStack `
  --resource MyEC2Instance `
  --region ap-south-1

üìå On failure
cfn-signal.exe -e 1 `
  --stack MyStack `
  --resource MyEC2Instance `
  --region ap-south-1

‚úÖ 4. cfn-get-metadata

Used to pull CloudFormation metadata for debugging.

üìå Example
cfn-get-metadata.exe `
  --stack MyStack `
  --resource MyEC2Instance `
  --region ap-south-1


This shows you the exact processed metadata that cfn-init uses.

üéØ Typical Windows UserData Example (All helper scripts)

Here is a fully correct CloudFormation Windows UserData block using all 4 helper scripts.

<powershell>

# Run cfn-init
cfn-init.exe -v `
  --stack MyStack `
  --resource MyEC2Instance `
  --region ap-south-1

# Start cfn-hup
Start-Service cfn-hup

# Signal success back to CloudFormation
cfn-signal.exe -e $LASTEXITCODE `
  --stack MyStack `
  --resource MyEC2Instance `
  --region ap-south-1

</powershell>

üß© Where These Tools Live on Windows

All helper scripts installed at:

C:\Program Files\Amazon\cfn-bootstrap\


Executable names:

cfn-init.exe
cfn-hup.exe
cfn-signal.exe
cfn-get-metadata.exe

üìå Summary (copy this anywhere)
CloudFormation Helper Scripts on Windows Servers
Script	Purpose
cfn-init	Apply CloudFormation metadata (packages, files, commands, services)
cfn-hup	Detect metadata changes and re-run cfn-init
cfn-signal	Report success/failure to CloudFormation for WaitCondition/CreationPolicy
cfn-get-metadata	Fetch and view metadata for debugging

**************

‚≠ê FULL CloudFormation Template ‚Äî Windows Server with Helper Scripts
AWSTemplateFormatVersion: 2010-09-09
Description: Windows Server EC2 using CloudFormation Helper Scripts (cfn-init, cfn-hup, cfn-signal)

Parameters:
  KeyName:
    Type: AWS::EC2::KeyPair::KeyName
    Description: Key pair for RDP login.

Resources:

  MyWindowsServer:
    Type: AWS::EC2::Instance
    Metadata:
      AWS::CloudFormation::Init:
        config:
          packages:
            msi:
              IIS: "http://download.microsoft.com/download/..."
          files:
            "C:/cfn/hooks.d/cfn-hup.conf":
              content: |
                [main]
                stack={{stack_name}}
                region={{region}}
                interval=5
                verbose=true
              mode: '000644'
              owner: Administrator
              group: Administrators

            "C:/cfn/hooks.d/iis-restart-hook.conf":
              content: |
                [cfn-auto-reloader-hook]
                triggers=post.update
                path=AWS::CloudFormation::Init
                action=cfn-init.exe -v --stack {{stack_name}} --resource MyWindowsServer --region {{region}}
                runas=Administrator
              mode: '000644'

            "C:/inetpub/wwwroot/index.html":
              content: "<h1>Hello from Windows Server via CloudFormation!</h1>"
              mode: '000644'

          commands:
            restart_iis:
              command: powershell.exe -Command "Restart-Service W3SVC"

          services:
            windows:
              cfn-hup:
                enabled: true
                ensureRunning: true
                files:
                  - "C:/cfn/hooks.d/cfn-hup.conf"
                  - "C:/cfn/hooks.d/iis-restart-hook.conf"
              W3SVC:
                enabled: true
                ensureRunning: true

    Properties:
      InstanceType: t2.micro
      ImageId: !Ref LatestAmiId
      KeyName: !Ref KeyName
      IamInstanceProfile: !Ref EC2Role
      SecurityGroupIds:
        - !Ref InstanceSG
      UserData:
        Fn::Base64: !Sub |
          <powershell>
          
          # Run cfn-init
          cfn-init.exe -v --stack ${AWS::StackName} --resource MyWindowsServer --region ${AWS::Region}

          # Start cfn-hup to monitor metadata
          Start-Service cfn-hup

          # Signal CloudFormation that setup is complete
          cfn-signal.exe -e $LASTEXITCODE --stack ${AWS::StackName} --resource MyWindowsServer --region ${AWS::Region}

          </powershell>

  # ---- IAM Role ----
  EC2Role:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Roles:
        - !Ref RolePolicies

  RolePolicies:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Principal:
              Service: ec2.amazonaws.com
            Action: sts:AssumeRole
      Policies:
        - PolicyName: CFNAccess
          PolicyDocument:
            Version: "2012-10-17"
            Statement:
              - Effect: Allow
                Action:
                  - cloudformation:*
                  - s3:*
                Resource: "*"

  # -------- Security Group --------
  InstanceSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Enable RDP
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3389
          ToPort: 3389
          CidrIp: 0.0.0.0/0

  # -------- Windows AMI Parameter --------
  LatestAmiId:
    Type: AWS::SSM::Parameter::Value<AWS::EC2::Image::Id>
    Default: /aws/service/ami-windows-latest/Windows_Server-2019-English-Full-Base

Outputs:
  InstanceId:
    Value: !Ref MyWindowsServer
  PublicIP:
    Value: !GetAtt MyWindowsServer.PublicIp