*******demo A: Code Deploy: Deploy Application package on Ec2(host server) from S3 as source

Step 1: Create a Linux EC2 instance. Add tag ex. name=web-server / environment=dev etc.
Create IAM role for ec2 to get access to s3.
Attach this IAM role to ec2
Reboot ec2( choose reboot option in Action menu of ec2)

Step 2: ssh into EC2 to install code deploy agent

sudo yum update -y
sudo yum install -y ruby wget
wget https://aws-codedeploy-eu-west-1.s3.eu-west-1.amazonaws.com/latest/install
chmod +x ./install
sudo ./install auto

Step 3: Check if code deploy agent installation is done successfully 
sudo service codedeploy-agent status

Step 4: Go to codedeploy service and click on create application.
Enter Application name as rajCodeDeploy
Compute Platform as Ec2/on premise and create application
Codedeploy application is created now

Step 5: Create role for CodeDeploy Deployment
Go to IAM service and Create code deploy role in IAM
Add S3fullaccess permissions also to this role

Step 6:
Now go to CodeDeploy application you have created in step 4
Create deployment group with name DevInstances
under service role select the codedeploy role that you have created in step 5
Environment configurations as Ec2 instances
Select tags ex. name=web-server / environment=dev to identify the ec2 instance
Disable load balancing ( because we are deploying on single ec2 instance)
Create Deployment group

Step 7: 
Create a new s3 bucket with name ex. code-deploy-bucketforsourcecode-raj
Enable versioning on this bucket
Create a Zip file of source code and upload source code in s3 bucket 

Step 8:
Go to CodeDeploy Application, open deployment group and Click on Create deployment
Select deployment group as DevInstances
Revision type is s3
Enter s3 URI of zip file object
Create deployment

Visit EC2 website

*******demo B: Code Deploy: Deploy package on Ec2 from GitHub as Source

Step 7: Now try with another revision type - GitHub
Go to CodeDeploy Application, open deployment group and Click on Create deployment
Select revision type as GitHub
Enter PAT token name ex. PATcicd ( you should have a PAT token created in your GitHub account)
Click on Connect to Gihub and small window appears . Click on confirm.
Enter repository name ex. Rajthetrainer/rajproject
Enter commit id which you want to deploy
Create deployment
Visit EC2 website





